<ng-container *ngIf="(filteredItems$ | async) as items; else loading">
  <div class="container-app">
    <!-- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–∏—Å–∫–∞ - –ø–µ—Ä–µ–¥–∞–µ–º —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞ —á–µ—Ä–µ–∑ Input -->
    <search-filtration-items-ui
      *ngIf="displayType === DisplayType.PRODUCTS"
      [searchTerm]="(currentSearchTerm$ | async) || ''"
      (filterItems)="onFilteredItems($event)">
    </search-filtration-items-ui>

    <div class="container-products" *ngIf="displayType === DisplayType.PRODUCTS">
      <div class="filters-info">
        <span *ngIf="(selectedCategory$ | async) as category" class="category-badge">
          –ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ category.name }}
          <button (click)="clearAllFilters()" class="clear-btn">√ó</button>
        </span>
        <span *ngIf="(currentSearchTerm$ | async) as searchTerm" class="search-badge">
          –ü–æ–∏—Å–∫: "{{ searchTerm }}"
          <span *ngIf="searchResultsCount$ | async as count" class="results-count">
            (–Ω–∞–π–¥–µ–Ω–æ: {{ count }})
          </span>
          <button (click)="clearAllFilters()" class="clear-btn">√ó</button>
        </span>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∂–∏–º–µ –ø–æ–∏—Å–∫–∞ -->
        <span *ngIf="(searchInfo$ | async) as searchInfo" class="search-note">
          <ng-container *ngIf="searchInfo">
            üîç –ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è {{ searchInfo.allProductsLoaded ? '–ª–æ–∫–∞–ª—å–Ω–æ –ø–æ ' + searchInfo.loadedCount + ' –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º —Ç–æ–≤–∞—Ä–∞–º' : '–ø–æ –≤—Å–µ–º —Ç–æ–≤–∞—Ä–∞–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ' }}
          </ng-container>
        </span>
      </div>
    </div>

    <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Å–∫—Ä–æ–ª–ª–∞ -->
    <infinite-scroll-container-ui
      [isLoading]="(loadingProducts$ | async) || false"
      [hasMore]="true"
      [isScrollable]="displayType === DisplayType.PRODUCTS"
      [maxHeight]="displayType === DisplayType.PRODUCTS ? '90vh' : 'none'"
      [loadingText]="'–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...'"
      [noMoreText]="'–í—Å–µ —Ç–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã'"
      (loadMore)="onLoadMore()">

      <product-list-ui
        [items]="items"
        [displayType]="displayType"
        [selectedCategory]="selectedCategory$ | async"
        (filterItems)="onFilteredItems($event)"
        (categoryItems)="onCategorySelect($event)">
      </product-list-ui>

    </infinite-scroll-container-ui>
  </div>
</ng-container>

<ng-template #loading>
  <div class="loading-container">
    <div class="spinner"></div>
    <div>–ó–∞–≥—Ä—É–∑–∫–∞...</div>
  </div>
</ng-template>
